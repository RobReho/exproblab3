\hypertarget{cluedo__sm_8py}{}\doxysection{scripts/cluedo\+\_\+sm.py File Reference}
\label{cluedo__sm_8py}\index{scripts/cluedo\_sm.py@{scripts/cluedo\_sm.py}}


This node handles the sstate machine of the robot.  


\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_armor__communication}{cluedo\+\_\+sm.\+Armor\+\_\+communication}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_initialization}{cluedo\+\_\+sm.\+Initialization}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_explore}{cluedo\+\_\+sm.\+Explore}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_collect__hints}{cluedo\+\_\+sm.\+Collect\+\_\+hints}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_make__hypothesis}{cluedo\+\_\+sm.\+Make\+\_\+hypothesis}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_reach__oracle}{cluedo\+\_\+sm.\+Reach\+\_\+oracle}}
\item 
class \mbox{\hyperlink{classcluedo__sm_1_1_hypothesis__check}{cluedo\+\_\+sm.\+Hypothesis\+\_\+check}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_af68517487bd19ed561cdd857486046dc}\label{cluedo__sm_8py_af68517487bd19ed561cdd857486046dc}} 
def {\bfseries cluedo\+\_\+sm.\+store\+\_\+hint} (data)
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a8ed82510a5ba614e58fb9c3ea2131b5d}\label{cluedo__sm_8py_a8ed82510a5ba614e58fb9c3ea2131b5d}} 
def \mbox{\hyperlink{cluedo__sm_8py_a8ed82510a5ba614e58fb9c3ea2131b5d}{cluedo\+\_\+sm.\+id\+\_\+to\+\_\+natural\+\_\+language}} (id)
\begin{DoxyCompactList}\small\item\em /brief id\+\_\+to\+\_\+natural\+\_\+language /param id\+: contains the hinst to be expressed /return\+: string containing the message Given the ID it returns the hints in type string in natural language \end{DoxyCompactList}\item 
def \mbox{\hyperlink{cluedo__sm_8py_a4ac11168d48b40057cd5ec48e84a1020}{cluedo\+\_\+sm.\+odom\+\_\+callback}} (msg)
\begin{DoxyCompactList}\small\item\em /brief Callback function for the odom topic that updates the actual position and yaw. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{cluedo__sm_8py_adbc1f520e821ff1a8342de513efb21ed}\label{cluedo__sm_8py_adbc1f520e821ff1a8342de513efb21ed}} 
def {\bfseries cluedo\+\_\+sm.\+main} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ad83d53311dc9ef322ef5b313f6e86cfa}\label{cluedo__sm_8py_ad83d53311dc9ef322ef5b313f6e86cfa}} 
list {\bfseries cluedo\+\_\+sm.\+people} = \mbox{[}\char`\"{}Miss\+Scarlett\char`\"{}, \char`\"{}Colonel\+Mustard\char`\"{}, \char`\"{}Mrs\+White\char`\"{}, \char`\"{}Mr\+Green\char`\"{}, \char`\"{}Mrs\+Peacock\char`\"{}, \char`\"{}Prof\+Plum\char`\"{}\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a8cc6207e659763d3ab88a9782fa07b53}\label{cluedo__sm_8py_a8cc6207e659763d3ab88a9782fa07b53}} 
list {\bfseries cluedo\+\_\+sm.\+weapons} = \mbox{[}\char`\"{}candlestick\char`\"{}, \char`\"{}dagger\char`\"{}, \char`\"{}lead\+Pipe\char`\"{}, \char`\"{}revolver\char`\"{}, \char`\"{}rope\char`\"{}, \char`\"{}spanner\char`\"{}\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a328c92563555d4dff4eb0da830174166}\label{cluedo__sm_8py_a328c92563555d4dff4eb0da830174166}} 
list {\bfseries cluedo\+\_\+sm.\+places} = \mbox{[}\char`\"{}conservatory\char`\"{}, \char`\"{}lounge\char`\"{}, \char`\"{}kitchen\char`\"{}, \char`\"{}library\char`\"{}, \char`\"{}hall\char`\"{}, \char`\"{}study\char`\"{}, \char`\"{}bathroom\char`\"{}, \char`\"{}dining\+Room\char`\"{}, \char`\"{}billiard\+Room\char`\"{}\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab47ab0f6c84f449456e21f783c57e188}\label{cluedo__sm_8py_ab47ab0f6c84f449456e21f783c57e188}} 
list {\bfseries cluedo\+\_\+sm.\+people\+\_\+list} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_afbb3e1685ae5e18b9ee4a8f9a8ba1c29}\label{cluedo__sm_8py_afbb3e1685ae5e18b9ee4a8f9a8ba1c29}} 
list {\bfseries cluedo\+\_\+sm.\+weapons\+\_\+list} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a772f3db6a9f6e4cb52869813a3fee376}\label{cluedo__sm_8py_a772f3db6a9f6e4cb52869813a3fee376}} 
list {\bfseries cluedo\+\_\+sm.\+places\+\_\+list} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a0c16ffe7defd1284f215851548fd035f}\label{cluedo__sm_8py_a0c16ffe7defd1284f215851548fd035f}} 
list {\bfseries cluedo\+\_\+sm.\+room1} = \mbox{[}5, 1\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ac6b9da889892af134eb630576ee0f0c1}\label{cluedo__sm_8py_ac6b9da889892af134eb630576ee0f0c1}} 
list {\bfseries cluedo\+\_\+sm.\+room2} = \mbox{[}-\/4, -\/3\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a65fda7c61acbc525f61a1f9e1b5efdd3}\label{cluedo__sm_8py_a65fda7c61acbc525f61a1f9e1b5efdd3}} 
list {\bfseries cluedo\+\_\+sm.\+room3} = \mbox{[}5, -\/3\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a6cfd22111061237a50667df1b9dbf17b}\label{cluedo__sm_8py_a6cfd22111061237a50667df1b9dbf17b}} 
list {\bfseries cluedo\+\_\+sm.\+room4} = \mbox{[}5, -\/7\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a3427ffc0cb537a1e89b10a11575c0f7b}\label{cluedo__sm_8py_a3427ffc0cb537a1e89b10a11575c0f7b}} 
list {\bfseries cluedo\+\_\+sm.\+room5} = \mbox{[}-\/4, 2\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a26e740712a6c237a39f0b8d1664e42d7}\label{cluedo__sm_8py_a26e740712a6c237a39f0b8d1664e42d7}} 
list {\bfseries cluedo\+\_\+sm.\+room6} = \mbox{[}-\/4, 7\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a296b724147a55df51c07721bf823ae2e}\label{cluedo__sm_8py_a296b724147a55df51c07721bf823ae2e}} 
list {\bfseries cluedo\+\_\+sm.\+rooms} = \mbox{[}room1, room2, room3, room4, room5, room6\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a8aaa208a0bc8cfd974e4c9e3b9e76ae8}\label{cluedo__sm_8py_a8aaa208a0bc8cfd974e4c9e3b9e76ae8}} 
list {\bfseries cluedo\+\_\+sm.\+oracle\+\_\+position} = \mbox{[}0, -\/1\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab5e9d2c4a98756aa6b1a5c274e3d0b9a}\label{cluedo__sm_8py_ab5e9d2c4a98756aa6b1a5c274e3d0b9a}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D0} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a1d286a6bd62c2f44b64f29a6e65f4a2d}\label{cluedo__sm_8py_a1d286a6bd62c2f44b64f29a6e65f4a2d}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D1} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a2354b9e548aec2c9e2358dbe16974c8b}\label{cluedo__sm_8py_a2354b9e548aec2c9e2358dbe16974c8b}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D2} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a72fa7de64f75d5e67f972ed594676ddc}\label{cluedo__sm_8py_a72fa7de64f75d5e67f972ed594676ddc}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D3} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a038ab3014eb383e5bb7f68bf0579e4c7}\label{cluedo__sm_8py_a038ab3014eb383e5bb7f68bf0579e4c7}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D4} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a24d4e7050680f3c6cdfa1a84fb41b53f}\label{cluedo__sm_8py_a24d4e7050680f3c6cdfa1a84fb41b53f}} 
list {\bfseries cluedo\+\_\+sm.\+I\+D5} = \mbox{[}$\,$\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab355f553632265a74183ae0b34999c7c}\label{cluedo__sm_8py_ab355f553632265a74183ae0b34999c7c}} 
list {\bfseries cluedo\+\_\+sm.\+I\+Ds} = \mbox{[}I\+D0,I\+D1,I\+D2,I\+D3,I\+D4,I\+D5\mbox{]}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a22eaf8891983b1d51c62bc5e6abc33e5}\label{cluedo__sm_8py_a22eaf8891983b1d51c62bc5e6abc33e5}} 
int {\bfseries cluedo\+\_\+sm.\+count\+\_\+hints} = 0
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a4e28fdf387bab540c89b7e952d3daf9a}\label{cluedo__sm_8py_a4e28fdf387bab540c89b7e952d3daf9a}} 
{\bfseries cluedo\+\_\+sm.\+actual\+\_\+position} = Point()
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab6ff477ba683c5e2dc41b540818de76f}\label{cluedo__sm_8py_ab6ff477ba683c5e2dc41b540818de76f}} 
{\bfseries cluedo\+\_\+sm.\+x}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a9ace1280a6ea40e4d2945f2eba10bebb}\label{cluedo__sm_8py_a9ace1280a6ea40e4d2945f2eba10bebb}} 
{\bfseries cluedo\+\_\+sm.\+y}
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab01879ef89a081cf203c5c22aad82aaa}\label{cluedo__sm_8py_ab01879ef89a081cf203c5c22aad82aaa}} 
int {\bfseries cluedo\+\_\+sm.\+actual\+\_\+yaw} = 0
\item 
\mbox{\Hypertarget{cluedo__sm_8py_ab12ef5502837ce46d44c2449d7dacc55}\label{cluedo__sm_8py_ab12ef5502837ce46d44c2449d7dacc55}} 
{\bfseries cluedo\+\_\+sm.\+oracle\+\_\+client} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a32c2a1f2a48d74e50d5b12819f94875f}\label{cluedo__sm_8py_a32c2a1f2a48d74e50d5b12819f94875f}} 
{\bfseries cluedo\+\_\+sm.\+pose\+\_\+client} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a14c745a57257b229820a9a0f6f1ed0bc}\label{cluedo__sm_8py_a14c745a57257b229820a9a0f6f1ed0bc}} 
{\bfseries cluedo\+\_\+sm.\+vel\+\_\+pub} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a91d3d14fc7b9f586a0d0f56632e6c693}\label{cluedo__sm_8py_a91d3d14fc7b9f586a0d0f56632e6c693}} 
{\bfseries cluedo\+\_\+sm.\+odom\+\_\+sub} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_a12a5a9486440d11212a49d02da18564a}\label{cluedo__sm_8py_a12a5a9486440d11212a49d02da18564a}} 
{\bfseries cluedo\+\_\+sm.\+mb} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_adce404316f14e75cfd00e890c98a3bee}\label{cluedo__sm_8py_adce404316f14e75cfd00e890c98a3bee}} 
{\bfseries cluedo\+\_\+sm.\+hint} = None
\item 
\mbox{\Hypertarget{cluedo__sm_8py_aca9afbdbd20dae05b99f4749ba8ac611}\label{cluedo__sm_8py_aca9afbdbd20dae05b99f4749ba8ac611}} 
{\bfseries cluedo\+\_\+sm.\+armor} = Armor\+\_\+communication()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This node handles the sstate machine of the robot. 

\begin{DoxyAuthor}{Author}
Roberta Reho 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
04/03/2023
\end{DoxyDate}
Subscribes to\+: ~\newline
 /odom /good\+\_\+hint

Publishes to\+: ~\newline
 None

Serivces\+: ~\newline
 /oracle\+\_\+hint

Client Services\+: ~\newline
 /oracle\+\_\+solution /arm\+\_\+pose /move\+\_\+base

Action Services\+: ~\newline
 None

Description\+: ~\newline
 This is the main component of the game, it handles the phases with a state machine and communicates with the nodes \char`\"{}myhints\char`\"{}, \char`\"{}simulation\char`\"{} and \char`\"{}move\+\_\+arm\char`\"{}. The implemented states are\+:
\begin{DoxyItemize}
\item I\+N\+IT\+: Initialization of the game. The robot arm get in the exploring position, A\+R\+M\+OR services are called to get the ontology ready. The state is executed again in case the hints fail to be uploaded on the owl file, procedes to the execution of the state \char`\"{}\+E\+X\+P\+L\+O\+R\+E R\+O\+O\+M\+S\char`\"{} otherwise.
\item E\+X\+P\+L\+O\+RE R\+O\+O\+MS\+: The robot reaches the centre of every room through the move\+\_\+base action server. The state is executed again in case the all the rooms have been explored, but the game is not over yet. Procedes to the execution of the state \char`\"{}\+C\+O\+L\+L\+E\+C\+T H\+I\+N\+T\+S\char`\"{} when the robot gets to the centre of the room.
\end{DoxyItemize}

C\+O\+L\+L\+E\+CT H\+I\+N\+TS\+: The robot checks if any ID collected enough hints to formulate a hypothesis. If so, the state \char`\"{}\+M\+A\+K\+E H\+Y\+P\+O\+T\+H\+E\+S\+I\+S\char`\"{} is executed, otherwise it goes back to the state \char`\"{}\+E\+X\+P\+L\+O\+R\+E R\+O\+O\+M\+S\char`\"{}.
\begin{DoxyItemize}
\item M\+A\+KE H\+Y\+P\+O\+T\+H\+E\+S\+IS\+: In this state the groups of 3 or more hints are uploaded to the ontology and checked for completeness and incosistency. The ID of consitent hypotesis is returned. If at least one ID has returned a consistent hypothesis, the state \char`\"{}\+R\+E\+A\+C\+H O\+R\+A\+C\+L\+E\char`\"{} is executed, otherwise the robot continues the exploration by returning to the state \char`\"{}\+E\+X\+P\+L\+O\+R\+E R\+O\+O\+M\+S\char`\"{}.
\item R\+E\+A\+CH O\+R\+A\+C\+LE\+: The robot reaches the oracle position \mbox{[}0,-\/1\mbox{]} using the same action server from the state \char`\"{}\+E\+X\+P\+L\+O\+R\+E R\+O\+O\+M\+S\char`\"{}. It is repeated if it fails to reach the position, otherwise executes the state \char`\"{}\+H\+Y\+P\+O\+T\+H\+E\+S\+I\+S C\+H\+E\+C\+K\char`\"{}.
\item H\+Y\+P\+O\+T\+H\+E\+S\+IS C\+H\+E\+CK\+: Gets the I\+Ds relative to consistent hypothesis and calls for the /oracle\+\_\+solution server to compare them with the winning ID. If one of the ID is the same as the winning ID the game ends, otherwise the robot goes back to the \char`\"{}\+E\+X\+P\+L\+O\+R\+E R\+O\+O\+M\+S\char`\"{} state. 
\end{DoxyItemize}

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{cluedo__sm_8py_a4ac11168d48b40057cd5ec48e84a1020}\label{cluedo__sm_8py_a4ac11168d48b40057cd5ec48e84a1020}} 
\index{cluedo\_sm.py@{cluedo\_sm.py}!odom\_callback@{odom\_callback}}
\index{odom\_callback@{odom\_callback}!cluedo\_sm.py@{cluedo\_sm.py}}
\doxysubsubsection{\texorpdfstring{odom\_callback()}{odom\_callback()}}
{\footnotesize\ttfamily def cluedo\+\_\+sm.\+odom\+\_\+callback (\begin{DoxyParamCaption}\item[{}]{msg }\end{DoxyParamCaption})}



/brief Callback function for the odom topic that updates the actual position and yaw. 

/param msg\+: msg The incoming message from the odom topic. /return\+: None This function updates the global variables actual\+\_\+position and actual\+\_\+yaw with the current position and yaw obtained from the incoming message. The actual position is obtained from the position field of the message\textquotesingle{}s pose field. The actual yaw is obtained from the orientation field of the message\textquotesingle{}s pose field. The orientation is converted from quaternion to Euler angles to obtain the yaw. 